<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Poro - Homework Automapper</title>
<style>
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    :root {
        --primary: #1c375b;
        --secondary: #6f8197;
        --accent: #ff6b6b;
        --accent2: #4facfe;
    }

    body {
        background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
        color: white;
        min-height: 100vh;
        background-size: 400% 400%;
        animation: gradientBg 20s ease infinite;
    }

    @keyframes gradientBg {
        0%, 100% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
    }

    *:focus {
        outline: none !important;
    }

    /* Custom scrollbar */
    ::-webkit-scrollbar {
        width: 10px;
    }

    ::-webkit-scrollbar-track {
        background: rgba(28, 55, 91, 0.3);
    }

    ::-webkit-scrollbar-thumb {
        background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 50%, #f093fb 100%);
        border-radius: 10px;
    }

    ::-webkit-scrollbar-thumb:hover {
        background: linear-gradient(135deg, #ff8787 0%, #ff6b6b 50%, #ee5a6f 100%);
    }

    * {
        scrollbar-width: thin;
        scrollbar-color: #ff6b6b rgba(28, 55, 91, 0.3);
    }

    /* Layout */
    .dashboard-container {
        display: flex;
        min-height: 100vh;
    }

    /* Sidebar */
    .sidebar {
        width: 280px;
        background: rgba(255, 255, 255, 0.08);
        backdrop-filter: blur(20px);
        border-right: 1px solid rgba(255, 255, 255, 0.1);
        display: flex;
        flex-direction: column;
        position: fixed;
        height: 100vh;
        z-index: 1000;
        transition: transform 0.3s ease;
    }

    .sidebar-header {
        padding: 30px 20px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .sidebar-logo {
        font-size: 2rem;
        font-weight: 700;
        background: linear-gradient(90deg, #ff6b6b 0%, #ee5a6f 50%, #f093fb 100%);
        background-clip: text;
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        text-align: center;
    }

    .sidebar-nav {
        flex: 1;
        padding: 20px 0;
        overflow-y: auto;
    }

    .nav-item {
        display: flex;
        align-items: center;
        gap: 15px;
        padding: 15px 25px;
        color: rgba(255, 255, 255, 0.8);
        text-decoration: none;
        transition: all 0.3s ease;
        cursor: pointer;
        position: relative;
        overflow: hidden;
    }

    .nav-item::before {
        content: '';
        position: absolute;
        left: 0;
        top: 0;
        height: 100%;
        width: 4px;
        background: linear-gradient(135deg, #ff6b6b 0%, #f093fb 100%);
        transform: scaleY(0);
        transition: transform 0.3s ease;
    }

    .nav-item:hover, .nav-item.active {
        background: rgba(255, 255, 255, 0.05);
        color: white;
    }

    .nav-item:hover::before, .nav-item.active::before {
        transform: scaleY(1);
    }

    .nav-icon {
        width: 24px;
        height: 24px;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .nav-icon svg {
        width: 100%;
        height: 100%;
        fill: currentColor;
    }

    .sidebar-footer {
        padding: 20px;
        border-top: 1px solid rgba(255, 255, 255, 0.1);
    }

    .user-profile {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 12px;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 12px;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .user-profile:hover {
        background: rgba(255, 255, 255, 0.1);
        transform: translateY(-2px);
    }

    .user-avatar {
        width: 45px;
        height: 45px;
        border-radius: 50%;
        background: linear-gradient(135deg, #ff6b6b 0%, #f093fb 100%);
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 700;
        font-size: 1.2rem;
        flex-shrink: 0;
    }

    .user-info {
        flex: 1;
        min-width: 0;
    }

    .user-name {
        font-weight: 600;
        font-size: 0.95rem;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .user-meta {
        font-size: 0.8rem;
        color: rgba(255, 255, 255, 0.6);
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    /* Mobile Menu Button */
    .mobile-menu-btn {
        display: none;
        position: fixed;
        top: 20px;
        left: 20px;
        z-index: 1001;
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(20px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 12px;
        padding: 12px;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .mobile-menu-btn:hover {
        background: rgba(255, 255, 255, 0.15);
    }

    .mobile-menu-btn svg {
        width: 24px;
        height: 24px;
        fill: white;
    }

    /* Main Content */
    .main-content {
        flex: 1;
        margin-left: 280px;
        padding: 30px;
        transition: margin-left 0.3s ease;
    }

    .content-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 40px;
    }

    .page-title {
        font-size: 2.5rem;
        font-weight: 700;
        background: linear-gradient(90deg, #ff6b6b 0%, #ee5a6f 50%, #f093fb 100%);
        background-clip: text;
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
    }

    .school-logo {
        width: 60px;
        height: 60px;
        background: rgba(255, 255, 255, 0.9);
        border-radius: 12px;
        padding: 8px;
        object-fit: contain;
    }

    /* Date Picker */
    .date-picker-container {
        background: rgba(255, 255, 255, 0.08);
        backdrop-filter: blur(20px);
        border-radius: 20px;
        border: 1px solid rgba(255, 255, 255, 0.1);
        padding: 25px;
        margin-bottom: 30px;
    }

    .date-picker-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
    }

    .date-picker-title {
        font-size: 1.4rem;
        font-weight: 600;
    }

    .date-display {
        font-size: 1.1rem;
        color: rgba(255, 255, 255, 0.8);
    }

    .date-input {
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 12px;
        padding: 12px 15px;
        color: white;
        font-size: 1rem;
        width: 100%;
        transition: all 0.3s ease;
    }

    .date-input:focus {
        border-color: #4facfe;
        box-shadow: 0 0 0 2px rgba(79, 172, 254, 0.3);
    }

    /* Periods Container */
    .periods-container {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
    }

    .period-card {
        background: rgba(255, 255, 255, 0.08);
        backdrop-filter: blur(20px);
        border-radius: 20px;
        border: 1px solid rgba(255, 255, 255, 0.1);
        padding: 25px;
        transition: all 0.3s ease;
    }

    .period-card:hover {
        border-color: rgba(255, 255, 255, 0.2);
        transform: translateY(-3px);
    }

    .period-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
        padding-bottom: 15px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .period-number {
        font-size: 1.3rem;
        font-weight: 600;
        color: #4facfe;
    }

    .period-time {
        font-size: 0.9rem;
        color: rgba(255, 255, 255, 0.7);
    }

    .tiffin-period .period-number {
        color: #ffb74d;
    }

    .end-period .period-number {
        color: #4caf50;
    }

    .homework-input-container {
        display: flex;
        flex-direction: column;
        gap: 12px;
    }

    /* New: Homework Input Area */
    .homework-input-area {
        display: flex;
        gap: 10px;
        align-items: flex-start;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 10px;
        padding: 12px;
    }

    .homework-main-input {
        background: transparent;
        border: none;
        color: white;
        font-size: 0.95rem;
        flex: 1;
        resize: none;
        min-height: 20px;
        max-height: 100px;
        overflow-y: auto;
    }

    .homework-main-input::placeholder {
        color: rgba(255, 255, 255, 0.5);
    }

    .add-homework-btn {
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.3);
        border-radius: 8px;
        padding: 8px;
        color: rgba(255, 255, 255, 0.7);
        font-size: 0.95rem;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        width: 36px;
        height: 36px;
        flex-shrink: 0;
    }

    .add-homework-btn:hover:not(:disabled) {
        background: rgba(255, 255, 255, 0.15);
        border-color: rgba(255, 255, 255, 0.5);
        color: white;
    }

    .add-homework-btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
    }

    .add-homework-btn svg {
        width: 16px;
        height: 16px;
        fill: currentColor;
    }

    /* Homework List */
    .homework-list {
        display: flex;
        flex-direction: column;
        gap: 12px;
    }

    .homework-item {
        display: flex;
        align-items: flex-start;
        gap: 10px;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 10px;
        padding: 12px;
        transition: all 0.3s ease;
        position: relative;
    }

    .homework-item.dragging {
        opacity: 0.5;
        transform: rotate(2deg);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.15);
    }

    .homework-item.deleting {
        transform: translateX(-100%);
        opacity: 0;
    }

    .drag-handle {
        color: rgba(255, 255, 255, 0.5);
        cursor: move;
        font-size: 16px;
        padding: 5px;
        border-radius: 6px;
        transition: all 0.2s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        width: 24px;
        height: 24px;
    }

    .drag-handle:hover {
        background: rgba(255, 255, 255, 0.1);
        color: #4facfe;
    }

    .homework-bullet {
        color: #ff6b6b;
        font-weight: bold;
        margin-top: 2px;
        flex-shrink: 0;
    }

    .homework-text {
        color: white;
        font-size: 0.95rem;
        flex: 1;
        word-break: break-word;
    }

    .delete-homework {
        background: none;
        border: none;
        color: rgba(255, 255, 255, 0.5);
        cursor: pointer;
        padding: 4px;
        border-radius: 4px;
        transition: all 0.3s ease;
        flex-shrink: 0;
        margin-top: 2px;
        width: 24px;
        height: 24px;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .delete-homework:hover {
        color: #ff6b6b;
        background: rgba(255, 107, 107, 0.1);
    }

    .delete-homework svg {
        width: 16px;
        height: 16px;
        fill: currentColor;
    }

    /* Submit Button */
    .submit-container {
        display: flex;
        justify-content: flex-end;
    }

    .submit-btn {
        background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        border: none;
        color: white;
        padding: 15px 30px;
        border-radius: 12px;
        font-weight: 600;
        font-size: 1rem;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .submit-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 5px 15px rgba(79, 172, 254, 0.4);
    }

    .submit-btn:disabled {
        background: rgba(255, 255, 255, 0.2);
        cursor: not-allowed;
        transform: none;
        box-shadow: none;
    }

    .submit-btn svg {
        width: 20px;
        height: 20px;
        fill: white;
    }

    /* Status Message */
    .status-message {
        background: rgba(255, 255, 255, 0.08);
        backdrop-filter: blur(20px);
        border-radius: 12px;
        padding: 15px 20px;
        margin-top: 20px;
        display: none;
        align-items: center;
        gap: 12px;
        animation: fadeIn 0.3s ease;
    }

    .status-message.success {
        background: rgba(76, 175, 80, 0.2);
        border: 1px solid rgba(76, 175, 80, 0.3);
    }

    .status-message.error {
        background: rgba(244, 67, 54, 0.2);
        border: 1px solid rgba(244, 67, 54, 0.3);
    }

    .status-message.show {
        display: flex;
    }

    .status-icon {
        width: 24px;
        height: 24px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 50%;
        flex-shrink: 0;
    }

    .status-message.success .status-icon {
        background: rgba(76, 175, 80, 0.3);
    }

    .status-message.error .status-icon {
        background: rgba(244, 67, 54, 0.3);
    }

    .status-icon svg {
        width: 16px;
        height: 16px;
        fill: white;
    }

    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(-10px); }
        to { opacity: 1; transform: translateY(0); }
    }

    /* Mobile Responsive */
    @media (max-width: 768px) {
        .sidebar {
            transform: translateX(-100%);
        }

        .sidebar.active {
            transform: translateX(0);
        }

        .mobile-menu-btn {
            display: block;
        }

        .main-content {
            margin-left: 0;
            padding: 80px 20px 20px 20px;
        }

        .content-header {
            flex-direction: column;
            gap: 20px;
            align-items: flex-start;
        }

        .page-title {
            font-size: 2rem;
        }

        .school-logo {
            position: fixed;
            top: 20px;
            right: 20px;
        }

        .periods-container {
            grid-template-columns: 1fr;
        }

        .date-picker-header {
            flex-direction: column;
            align-items: flex-start;
            gap: 10px;
        }

        .submit-container {
            justify-content: center;
        }

        .submit-btn {
            width: 100%;
            justify-content: center;
        }
        
        /* Mobile input area adjustment */
        .homework-input-area {
            flex-direction: column;
        }
        
        .add-homework-btn {
            align-self: flex-end;
            width: auto;
            padding: 8px 16px;
        }
    }
</style>
</head>
<body>
    <div class="dashboard-container">
        <!-- Mobile Menu Button -->
        <button class="mobile-menu-btn" onclick="toggleSidebar()">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
            </svg>
        </button>

        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-logo">Poro</div>
            </div>

            <nav class="sidebar-nav">
                <a href="/dashboard" class="nav-item">
                    <span class="nav-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                            <path d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z"/>
                        </svg>
                    </span>
                    <span>Dashboard</span>
                </a>
                <a href="/settings" class="nav-item">
                    <span class="nav-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                            <path d="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"/>
                        </svg>
                    </span>
                    <span>Settings</span>
                </a>
                <a href="/announcements" class="nav-item">
                    <span class="nav-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                            <path d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.89 2 2 2zm6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2z"/>
                        </svg>
                    </span>
                    <span>Announcements</span>
                </a>
                <a href="/routine" class="nav-item">
                    <span class="nav-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                            <path d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z"/>
                        </svg>
                    </span>
                    <span>Routine</span>
                </a>
                <a href="/teachers" class="nav-item">
                    <span class="nav-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                            <path d="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"/>
                        </svg>
                    </span>
                    <span>Teachers</span>
                </a>
                <a href="/homework" class="nav-item active">
                    <span class="nav-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                            <path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"/>
                        </svg>
                    </span>
                    <span>Homework</span>
                </a>
            </nav>

            <div class="sidebar-footer">
                <a href="/profile" class="user-profile">
                    <div class="user-avatar">JD</div>
                    <div class="user-info">
                        <div class="user-name">John Doe</div>
                        <div class="user-meta">@johndoe • Class 10-A</div>
                    </div>
                </a>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <div class="content-header">
                <h1 class="page-title">Homework Automapper</h1>
                <img src="https://via.placeholder.com/60" alt="college_logo" class="school-logo">
            </div>

            <!-- Date Picker -->
            <div class="date-picker-container">
                <div class="date-picker-header">
                    <h2 class="date-picker-title">Select Date</h2>
                    <div class="date-display" id="dateDisplay"></div>
                </div>
                <input type="date" class="date-input" id="dateInput">
            </div>

            <!-- Periods Container -->
            <div class="periods-container" id="periodsContainer">
                <!-- Periods will be generated by JavaScript -->
            </div>

            <!-- Submit Button -->
            <div class="submit-container">
                <button class="submit-btn" id="submitBtn" onclick="submitHomework()">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/>
                    </svg>
                    Submit Homework
                </button>
            </div>

            <!-- Status Message -->
            <div class="status-message" id="statusMessage">
                <div class="status-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
                    </svg>
                </div>
                <span id="statusText">Homework submitted successfully!</span>
            </div>
        </main>
    </div>

<script>
    // Toggle sidebar for mobile
    function toggleSidebar() {
        const sidebar = document.getElementById('sidebar');
        sidebar.classList.toggle('active');
    }

    // Close sidebar when clicking outside on mobile
    document.addEventListener('click', function(event) {
        const sidebar = document.getElementById('sidebar');
        const menuBtn = document.querySelector('.mobile-menu-btn');

        if (window.innerWidth <= 768 &&
            sidebar.classList.contains('active') &&
            !sidebar.contains(event.target) &&
            !menuBtn.contains(event.target)) {
            sidebar.classList.remove('active');
        }
    });

    // Initialize date picker with today's date
    function initializeDatePicker() {
        const dateInput = document.getElementById('dateInput');
        const dateDisplay = document.getElementById('dateDisplay');
        
        // Set today's date as default
        const today = new Date();
        const formattedDate = formatDateForInput(today);
        dateInput.value = formattedDate;
        
        // Update display
        updateDateDisplay(today);
        
        // Add event listener for date changes
        dateInput.addEventListener('change', function() {
            const selectedDate = new Date(this.value);
            updateDateDisplay(selectedDate);
        });
    }

    // Format date for input field (YYYY-MM-DD)
    function formatDateForInput(date) {
        const year = date.getFullYear();
        const month = String(date.getMonth() + 1).padStart(2, '0');
        const day = String(date.getDate()).padStart(2, '0');
        return `${year}-${month}-${day}`;
    }

    // Format date for display
    function updateDateDisplay(date) {
        const dateDisplay = document.getElementById('dateDisplay');
        const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
        dateDisplay.textContent = date.toLocaleDateString('en-US', options);
    }

    // Get formatted date for API (DDMMYYYY)
    function getFormattedDateForAPI() {
        const dateInput = document.getElementById('dateInput');
        const date = new Date(dateInput.value);
        
        const day = String(date.getDate()).padStart(2, '0');
        const month = String(date.getMonth() + 1).padStart(2, '0');
        const year = date.getFullYear();
        
        return `${day}${month}${year}`;
    }

    // Get day name for API
    function getDayName() {
        const dateInput = document.getElementById('dateInput');
        const date = new Date(dateInput.value);
        const days = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
        return days[date.getDay()];
    }

    // Generate periods data
    function generatePeriodsData() {
        return [
            { number: 1, time: '8:00 AM - 9:00 AM', type: 'period' },
            { number: 2, time: '9:00 AM - 10:00 AM', type: 'period' },
            { number: 3, time: '10:00 AM - 11:00 AM', type: 'period' },
            { number: 4, time: '11:30 AM - 12:30 PM', type: 'period' },
            { number: 5, time: '12:30 PM - 1:30 PM', type: 'period' },
            { number: 6, time: '1:30 PM - 2:30 PM', type: 'period' },
            { number: 'Tiffin', time: '11:00 AM - 11:30 AM', type: 'tiffin' },
            { number: 'End', time: '2:30 PM', type: 'end' }
        ];
    }

    // Render periods
    function renderPeriods() {
        const periodsData = generatePeriodsData();
        const container = document.getElementById('periodsContainer');

        container.innerHTML = periodsData.map(period => {
            const periodClass = period.type === 'tiffin' ? 'tiffin-period' : 
                              period.type === 'end' ? 'end-period' : '';
            
            return `
                <div class="period-card ${periodClass}">
                    <div class="period-header">
                        <span class="period-number">${period.type === 'period' ? 'Period ' : ''}${period.number}</span>
                        <span class="period-time">${period.time}</span>
                    </div>
                    <div class="homework-input-container" data-period="${period.number}">
                        <!-- Input area with add button -->
                        <div class="homework-input-area">
                            <textarea class="homework-main-input" placeholder="Enter homework item..." oninput="handleMainInput(this)"></textarea>
                            <button class="add-homework-btn" onclick="addHomeworkFromInput(this)" disabled>
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                    <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                                </svg>
                            </button>
                        </div>
                        <!-- Homework list -->
                        <div class="homework-list"></div>
                    </div>
                </div>
            `;
        }).join('');
    }

    // Handle main input changes
    function handleMainInput(textarea) {
        const addBtn = textarea.parentElement.querySelector('.add-homework-btn');
        const value = textarea.value.trim();
        
        if (value !== '') {
            addBtn.disabled = false;
        } else {
            addBtn.disabled = true;
        }
    }

    // Add homework from main input
    function addHomeworkFromInput(button) {
        const container = button.closest('.homework-input-container');
        const mainInput = container.querySelector('.homework-main-input');
        const value = mainInput.value.trim();
        
        if (value === '') return;
        
        // Create homework item
        const homeworkItem = createHomeworkItem(value);
        const homeworkList = container.querySelector('.homework-list');
        
        // Add to the end of the list
        homeworkList.appendChild(homeworkItem);
        
        // Clear main input and disable button
        mainInput.value = '';
        button.disabled = true;
        
        // Initialize drag for new item
        initDragAndDrop();
    }

    // Handle Enter key in main input
    function handleMainInputEnter(event, textarea) {
        if (event.key === 'Enter' && !event.shiftKey) {
            event.preventDefault();
            const addBtn = textarea.parentElement.querySelector('.add-homework-btn');
            if (!addBtn.disabled) {
                addHomeworkFromInput(addBtn);
            }
        }
    }

    // Create homework item element
    function createHomeworkItem(text) {
        const homeworkItem = document.createElement('div');
        homeworkItem.className = 'homework-item';
        homeworkItem.innerHTML = `
            <div class="drag-handle">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16">
                    <path d="M9 3h6v2H9zm0 8h6v2H9zm0 8h6v2H9z" fill="currentColor"/>
                </svg>
            </div>
            <span class="homework-bullet">•</span>
            <div class="homework-text">${text}</div>
            <button class="delete-homework" onclick="deleteHomeworkItem(this)">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                </svg>
            </button>
        `;
        return homeworkItem;
    }

    // Delete homework item with slide animation
    function deleteHomeworkItem(button) {
        const homeworkItem = button.closest('.homework-item');
        homeworkItem.classList.add('deleting');
        setTimeout(() => {
            homeworkItem.remove();
        }, 300);
    }

    // Drag and drop functionality
    let draggedItem = null;

    function initDragAndDrop() {
        const dragHandles = document.querySelectorAll('.drag-handle');
        
        dragHandles.forEach(handle => {
            handle.addEventListener('mousedown', function(e) {
                draggedItem = this.parentElement;
                draggedItem.classList.add('dragging');
                
                // Prevent text selection during drag
                e.preventDefault();
            });
        });
        
        document.addEventListener('mousemove', function(e) {
            if (!draggedItem) return;
            
            // Find the homework item under the cursor
            const mouseY = e.clientY;
            const container = draggedItem.closest('.homework-list');
            const items = Array.from(container.querySelectorAll('.homework-item:not(.dragging)'));
            
            for (let i = 0; i < items.length; i++) {
                const rect = items[i].getBoundingClientRect();
                const midpoint = rect.top + rect.height / 2;
                
                if (mouseY < midpoint) {
                    // Insert before this item
                    container.insertBefore(draggedItem, items[i]);
                    return;
                }
            }
            
            // If we're at the end, append
            container.appendChild(draggedItem);
        });
        
        document.addEventListener('mouseup', function() {
            if (draggedItem) {
                draggedItem.classList.remove('dragging');
                draggedItem = null;
            }
        });
    }

    // Get homework data for all periods
    function getHomeworkData() {
        const periods = [];
        const periodContainers = document.querySelectorAll('.homework-input-container');
        
        periodContainers.forEach(container => {
            const periodNumber = container.getAttribute('data-period');
            const homeworkItems = [];
            
            const textElements = container.querySelectorAll('.homework-text');
            textElements.forEach(el => {
                homeworkItems.push(el.textContent.trim());
            });
            
            periods.push({
                period: periodNumber,
                homework: homeworkItems
            });
        });
        
        return periods;
    }

    // Submit homework
    async function submitHomework() {
        const submitBtn = document.getElementById('submitBtn');
        const statusMessage = document.getElementById('statusMessage');
        const statusText = document.getElementById('statusText');
        
        // Disable submit button
        submitBtn.disabled = true;
        submitBtn.innerHTML = `
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" style="animation: spin 1s linear infinite;">
                <path d="M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"/>
            </svg>
            Submitting...
        `;
        
        try {
            const homeworkData = getHomeworkData();
            const date = getFormattedDateForAPI();
            const day = getDayName();
            
            // Create API calls for each period
            const apiCalls = homeworkData.map(periodData => {
                const payload = {
                    date: date,
                    day: day,
                    period: periodData.period,
                    homework: periodData.homework
                };
                
                // Make parallel API calls (fire and forget)
                return fetch('https://example.com/api/automapper', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(payload)
                }).catch(error => {
                    console.error(`Error submitting period ${periodData.period}:`, error);
                });
            });
            
            // Wait for all API calls to complete (but don't block)
            await Promise.allSettled(apiCalls);
            
            // Show success message
            statusMessage.className = 'status-message success show';
            statusText.textContent = 'Homework submitted successfully!';
            
            // Hide status message after 3 seconds
            setTimeout(() => {
                statusMessage.classList.remove('show');
            }, 3000);
            
        } catch (error) {
            console.error('Error submitting homework:', error);
            
            // Show error message
            statusMessage.className = 'status-message error show';
            statusText.textContent = 'Error submitting homework. Please try again.';
        } finally {
            // Re-enable submit button
            submitBtn.disabled = false;
            submitBtn.innerHTML = `
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/>
                </svg>
                Submit Homework
            `;
        }
    }

    // Add spin animation for loading
    const style = document.createElement('style');
    style.textContent = `
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    `;
    document.head.appendChild(style);

    // Initialize the page
    document.addEventListener('DOMContentLoaded', function() {
        initializeDatePicker();
        renderPeriods();
    });
</script>
</body>
</html>